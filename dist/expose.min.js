/*! expose.js - v0.1.0 - 2013-08-19
 * https://github.com/wnr/expose.js
 * Copyright (c) 2013 Lucas Wiener; Licensed MIT
 */


!function(a){"use strict";a.run=function(){}}(this.expose=this.expose||{}),function(a){"use strict";if(!a)throw new Error("Invalid expose given.");return a.log?(a.log("A log function is already defined. Discarding log module."),void 0):(a.log=function(){if(console&&console.log){for(var a,b=0;b<arguments.length;b++)a+=arguments[b],b+1===arguments.length&&(a+=" ");a&&console.log(a)}},void 0)}(this.expose=this.expose||{}),function(a,b){"use strict";if(!a)throw new Error("Invalid expose given.");if(a.ajax)return a.log("An ajax function is already. Discarding ajax module."),void 0;var c=function(){var a=!1;try{a=new b.XMLHttpRequest}catch(c){a=new b.ActiveXObject("Microsoft.XMLHTTP")}return function(){return a}}();a.ajax=function(a,b){var d=c();d&&(d.open("GET",a,!0),d.onreadystatechange=function(){4!==d.readyState||200!==d.status&&304!==d.status||b(d.responseText)},4!==d.readyState&&d.send(null))}}(this.expose=this.expose||{},this),function(a){"use strict";if(!a)throw new Error("Invalid expose given.");if(a.css)return a.log("A css object already exists. Discarding css module."),void 0;a.css={};var b=a.css;b.rules=[],b.getInternal=function(a){if("function"!=typeof a)throw new Error("Callback required");var b="";$("style").each(function(a,c){b+=$(c).html()}),a(b)},b.getExternal=function(b){function c(a){return a.href&&a.href.length>0}function d(){for(var a=[],b=0;b<document.styleSheets.length;b++){var d=document.styleSheets[b];c(d)&&a.push(d)}return a}function e(b,c){function d(b){var d=Array.prototype.slice.call(arguments,2);d.unshift(b),c.apply(a,d)}if(b.cssText)return d(b.cssText),void 0;var e=b.cssRules||b.rules||null;if(!e)return a.ajax(b.href,function(d){if(d===!1)throw new Error("Failed to read rules of stylesheet");a.log("Read external stylesheet with ajax:",b.href),c(d)}),void 0;for(var f="",g=0;g<e.length;g++){var h=e[g];f+=h.cssText}d(f)}if("function"!=typeof b)throw new Error("Callback required");for(var f="",g=d(),h=0,i=function(a){f+=a,h++,h===g.length&&b(f)},j=0;j<g.length;j++)e(g[j],i)},b.updateStyles=function(c){function d(d){if(e){e+=d;for(var f=a.parseCSS(e).stylesheet.rules,g=0;g<f.length;g++){var h=f[g];"rule"===h.type&&b.rules.push(h)}c()}else e+=d}var e;b.getInternal(d),b.getExternal(d)},b.getSupportedProperties=function(){function a(a){if(document.defaultView.getComputedStyle)return document.defaultView.getComputedStyle(a,null);if(a.currentStyle)return a.currentStyle;throw new Error("Failed to retrieve computed style.")}for(var b=[],c=a($(":root")[0]),d=0;d<c.length;d++)b.push(c[d]);return b},b.getStyleByCSS=function(b){function c(b,c,d,e){function f(a,b){return b&&!!~a.search(new RegExp(b,"i"))}for(var g=[],h=0;h<a.css.rules.length;h++)for(var i=0;i<a.css.rules[h].selectors.length;i++){var j=a.css.rules[h].selectors[i];if(f(j,b)||f(j,c)||f(j,d))g.push(a.css.rules[h]);else for(var k=0;k<e.length;k++)if(f(j,e[h])){g.push(a.css.rules[h]);break}}return g}if(!b||0===b.length)throw new Error("Invalid arguments.");for(var d=[],e=b;e.prop("tagName");e=e.parent()){var f=e.prop("tagName"),g=e.prop("id"),h=e.prop("name"),i=e.prop("class").split(" ");$.merge(d,c(f,g,h,i))}console.log("hej")},b.getComputedStyle=function(a){if(!a||0===a.length)throw new Error("Invalid arguments.");for(var c=b.getSupportedProperties(),d=[],e=0;e<c.length;e++){var f=c[e],g={};g.property=f,g.value=a.css(f),d.push(g)}return d},b.diff=function(a,b){function c(a,b){for(var c=0;c<a.length;c++)if(a[c].property===b)return c;return-1}for(var d=[],e=jQuery.parseJSON(a),f=jQuery.parseJSON(b),g=0;g<e.length;g++){var h=e[g].property,i=e[g].value,j=c(f,h);~j?i!==f[j].value&&d.push({type:"value",first:e[g],second:f[j]}):d.push({type:"missing",first:e[g]})}for(var k=g+1;k<f.length;k++)d.push({type:"missing",second:f[k]});return d}}(this.expose=this.expose||{}),function(a){if(!a)throw new Error("Invalid expose given.");a.parseCSS||(a.parseCSS=function(a,b){function c(a){if(void 0===a||null===a)throw new TypeError("trim called on null or undefined");var b="	\n\f\r   ᠎             　\u2028\u2029﻿";if(!String.prototype.trim||b.trim()){b="["+b+"]";var c=new RegExp("^"+b+b+"*"),d=new RegExp(b+b+"*$");return String(a).replace(c,"").replace(d,"")}return String(a).trim()}function d(a){var b=a.match(/\n/g);b&&(E+=b.length);var c=a.lastIndexOf("\n");F=~c?a.length-c:F+a.length}function e(){var a={line:E,column:F};return b.position?function(b){return b.position={start:a,end:{line:E,column:F}},m(),b}:f}function f(a){return m(),a}function g(b){var c=new Error(b+" near line "+E+":"+F);throw c.line=E,c.column=F,c.source=a,c}function h(){return{type:"stylesheet",stylesheet:{rules:k()}}}function i(){return l(/^{\s*/)}function j(){return l(/^}/)}function k(){var b,c=[];for(m(),n(c);"}"!=a.charAt(0)&&(b=C()||D());)c.push(b),n(c);return c}function l(b){var c=b.exec(a);if(c){var e=c[0];return d(e),a=a.slice(e.length),c}}function m(){l(/^\s*/)}function n(a){var b;for(a=a||[];b=o();)a.push(b);return a}function o(){var b=e();if("/"==a.charAt(0)&&"*"==a.charAt(1)){for(var c=2;null!=a.charAt(c)&&("*"!=a.charAt(c)||"/"!=a.charAt(c+1));)++c;c+=2;var f=a.slice(2,c-2);return F+=2,d(f),a=a.slice(c),F+=2,b({type:"comment",comment:f})}}function p(){var a=l(/^([^{]+)/);if(a)return c(a[0]).split(/\s*,\s*/)}function q(){var a=e(),b=l(/^(\*?[-\/\*\w]+)\s*/);if(b){if(b=b[0],!l(/^:\s*/))return g("property missing ':'");var d=l(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/);if(!d)return g("property missing value");var f=a({type:"declaration",property:b,value:c(d[0])});return l(/^[;\s]*/),f}}function r(){var a=[];if(!i())return g("missing '{'");n(a);for(var b;b=q();)a.push(b),n(a);return j()?a:g("missing '}'")}function s(){for(var a,b=[],c=e();a=l(/^(from|to|\d+%|\.\d+%|\d+\.\d+%)\s*/);)b.push(a[1]),l(/^,\s*/);return b.length?c({type:"keyframe",values:b,declarations:r()}):void 0}function t(){var a=e(),b=l(/^@([-\w]+)?keyframes */);if(b){var c=b[1],b=l(/^([-\w]+)\s*/);if(!b)return g("@keyframes missing name");var d=b[1];if(!i())return g("@keyframes missing '{'");for(var f,h=n();f=s();)h.push(f),h=h.concat(n());return j()?a({type:"keyframes",name:d,vendor:c,keyframes:h}):g("@keyframes missing '}'")}}function u(){var a=e(),b=l(/^@supports *([^{]+)/);if(b){var d=c(b[1]);if(!i())return g("@supports missing '{'");var f=n().concat(k());return j()?a({type:"supports",supports:d,rules:f}):g("@supports missing '}'")}}function v(){var a=e(),b=l(/^@media *([^{]+)/);if(b){var d=c(b[1]);if(!i())return g("@media missing '{'");var f=n().concat(k());return j()?a({type:"media",media:d,rules:f}):g("@media missing '}'")}}function w(){var a=e(),b=l(/^@page */);if(b){var c=p()||[];if(!i())return g("@page missing '{'");for(var d,f=n();d=q();)f.push(d),f=f.concat(n());return j()?a({type:"page",selectors:c,declarations:f}):g("@page missing '}'")}}function x(){var a=e(),b=l(/^@([-\w]+)?document *([^{]+)/);if(b){var d=c(b[1]||""),f=c(b[2]);if(!i())return g("@document missing '{'");var h=n().concat(k());return j()?a({type:"document",document:f,vendor:d,rules:h}):g("@document missing '}'")}}function y(){return B("import")}function z(){return B("charset")}function A(){return B("namespace")}function B(a){var b=e(),d=l(new RegExp("^@"+a+" *([^;\\n]+);"));if(d){var f={type:a};return f[a]=c(d[1]),b(f)}}function C(){return t()||v()||u()||y()||z()||A()||x()||w()}function D(){var a=e(),b=p();return b?(n(),a({type:"rule",selectors:b,declarations:r()})):void 0}b=b||{};var E=1,F=1;return h()})}(this.expose=this.expose||{});